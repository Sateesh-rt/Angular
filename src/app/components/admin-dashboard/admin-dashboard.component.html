<p-toast></p-toast>
<nav class="navbar navbar-expand-lg navbar-light bg-light px-4 shadow-sm">

  <h1> ðŸ›’ E-COMMERCE</h1>
  <i class="fa-brands fa-youtube"></i>

  <div class="ms-auto d-flex align-items-center">
   <div class="dropdown me-3">
      
     <img src="/assets/images/profile.jpeg" 
             alt="User Avatar" 
             class="rounded-circle" 
             width="40" height="40" 
             style="cursor: pointer;"
             (click)="goToUserDetails()"/>
      
    </div>


    <button class="btn btn-outline-danger" (click)="logout()">
      Logout
    </button>
  </div>
</nav>


<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h4 class="mb-0 text-center">Admin Dashboard - Add Product</h4>
    </div>

    <div class="card-body">
      <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label for="name">ProductName <span class="text-danger">*</span></label>
            <input type="text" formControlName="name" placeholder="Product Name" class="form-control" />
            <div *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched " class="text-danger">Field
              is Required</div>
          </div>
          <div class="col-md-6">
            <label for="description">Description<span class="text-danger">*</span></label>
            <input type="text" formControlName="description" placeholder="Description" class="form-control" />
            <div *ngIf="productForm.get('description')?.invalid && productForm.get('description')?.touched "
              class="text-danger">Field is Required</div>
          </div>
          <div class="col-md-4">
            <label for="price">Price <span class="text-danger">*</span></label>
            <input type="number" formControlName="price" placeholder="Price" class="form-control" />
            <div *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched " class="text-danger">
              Field is Required</div>
          </div>
          <div class="col-md-4">
            <label for="category">Select Category <span class="text-danger">*</span></label>
            <select formControlName="category" class="form-control">
              <option value="">-- Select Category --</option>
              <option value="Mobiles">Mobiles</option>
              <option value="Fashion">Fashion</option>
              <option value="Electronics">Electronics</option>
            </select>
            <div *ngIf="productForm.get('category')?.invalid && productForm.get('category')?.touched "
              class="text-danger">Field is Required</div>
          </div>
          <div class="col-md-4">
            <label class="form-label">Product Image <span class="text-danger">*</span></label><br>

            
            <input   type="file" #fileInput hidden (change)="onImageSelected($event)" />

          
            <button type="button" class="btn btn-primary btn-sm me-2" (click)="fileInput.click()">Upload</button>
            <button type="button" class="btn btn-success btn-sm" (click)="openModal()">View</button>

            <p class="text-primary small mt-1" *ngIf="imageFile">{{ imageFile.name }}</p>
          </div>

         
          <div class="modal" tabindex="-1" [ngClass]="{ 'show d-block': showModal }" *ngIf="showModal">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">

                
                <div class="modal-header">
                  <h5 class="modal-title">Product Image Preview</h5>
                  <button type="button" class="btn-close" aria-label="Close" (click)="closeModal()"></button>
                </div>

           
                <div class="modal-body text-center">
                  <img [src]="imageUrl" alt="Preview" class="img-fluid" style="max-height: 300px;" />
                </div>

              </div>
            </div>
          </div>


          <!-- Image Preview -->
        </div>

        <div class="text-center mt-3">
          <button type="submit" class="btn btn-success me-2">
            {{ isUpdate ? 'Update Product' : 'Add Product' }}
          </button>
          <button *ngIf="isUpdate" type="button" (click)="resetForm()" class="btn btn-secondary">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <hr class="my-4" />

  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h5 class="mb-0 text-center">Product List</h5>
    </div>
    <div class="card-body table-responsive">
      <table class="table table-bordered table-hover text-center align-middle">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price (â‚¹)</th>
            <th>Category</th>
            <th>Image</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of products">
            <td>{{ product.name }}</td>
            <td>{{ product.description }}</td>
            <td>{{ product.price }}</td>
            <td>{{ product.category }}</td>
            <td>
              <img *ngIf="product.imageUrl" [src]="product.imageUrl" width="60" height="60" class="img-thumbnail" />
            </td>
            <td>
              <div class="d-flex gap-2">
                <button class="btn btn-warning btn-sm" (click)="onEdit(product.id)">Edit</button>
                <button class="btn btn-danger btn-sm" (click)="onDelete(product.id)">Delete</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>